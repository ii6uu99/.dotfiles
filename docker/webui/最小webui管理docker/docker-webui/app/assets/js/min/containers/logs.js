!function e(t,n,a){function l(i,o){if(!n[i]){if(!t[i]){var c="function"==typeof require&&require;if(!o&&c)return c(i,!0);if(r)return r(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return l(n?n:e)},u,u.exports,e,t,n,a)}return n[i].exports}for(var r="function"==typeof require&&require,i=0;i<a.length;i++)l(a[i]);return l}({1:[function(e,t,n){function a(e){var t=$('#refresh-window a[href="#'+e+'"]'),n=t.closest(".btn-group").removeClass("open");u=e,app.storage.set("refresh-window-logs",e),n.find(".caption").text("refresh / "+t.text()).blur()}function l(e){var t=$('#monitoring-count a[href="#'+e+'"]'),n=t.closest(".btn-group").removeClass("open");d=e,app.storage.set("monitoring-count-logs",e),n.find(".caption").text(t.text()).blur()}function r(){u&&u>0&&ReactDOM.render(React.createElement(m,{reload:!0}),document.getElementById("data")),setTimeout(r,1e3*Math.max(1,u))}function i(e){var t=$(".client-filters").hide(),n=!1,a=0;if(t.find("ul.dropdown-menu").html(""),$.map(e,function(e){n||c.client!=e.key||(n=e.value),a++}),n&&t.find(".caption").text(n),!(a<=1)){var l='<li><a href="#-1">All</a></li>';$.map(e,function(e){l+='<li><a href="#'+e.key+'">'+e.value+"</a></li>"}),t.find("ul.dropdown-menu").html(l),t.fadeIn(),$("#client-filter .dropdown-menu a").click(function(e){var t=$(this),n=t.closest(".btn-group").removeClass("open");n.find(".caption").text(t.text()).blur(),c.client=t.attr("href").substring(1),ReactDOM.render(React.createElement(m,{reload:!1}),document.getElementById("data")),app.func.stop(e)})}}function o(e){var t=$(".label-filters").hide(),n=!1,a=0;if(t.find("ul.dropdown-menu").html(""),$.map(e,function(e){n||c.label!=app.func.hash(e.key+"->"+e.value)||(n=e.value),a++}),n||c.label!=-1||(n="Not Labeled"),n&&t.find(".caption").text(n),!(a<=1)){var l='<li><a href="#0">All</a></li>',r="";l+='<li><a href="#-1">Not Labeled</a></li>',$.map(e,function(e){r!=e.key&&(l+='<li class="dropdown-header">'+e.key+"</li>",r=e.key);var t=e.value;t.length>20&&(t=t.substring(0,20)+".."),t="&nbsp;&nbsp;&nbsp;&nbsp;"+t,l+='<li><a href="#'+app.func.hash(e.key+"->"+e.value)+'">'+t+"</a></li>"}),t.find("ul.dropdown-menu").html(l),t.fadeIn(),$("#label-filter .dropdown-menu a").click(function(e){var t=$(this),n=t.closest(".btn-group").removeClass("open");if(n.find(".caption").text(t.text().trim()).blur(),c.label=t.attr("href").substring(1),ReactDOM.render(React.createElement(m,{reload:!1}),document.getElementById("data")),window.history&&window.history.pushState){var a=0==c.label?"/logs":"/logs?l="+c.label;history.pushState(null,null,a)}app.func.stop(e)})}}var c={client:app.func.query("c",-1),label:parseInt(app.func.query("l","0"),10)},s=[],u=app.storage.get("refresh-window-logs",1),d=app.storage.get("monitoring-count-logs",20),p=[];$(document).ready(function(){$("#menu-logs").addClass("active"),a(u),$("#refresh-window a").click(function(e){a(parseInt($(this).attr("href").substring(1),10)),app.func.stop(e)}),l(d),$("#monitoring-count a").click(function(e){l(parseInt($(this).attr("href").substring(1),10)),app.func.stop(e)}),app.func.ajax({url:"/api/containers",data:{status:3},success:function(e){s=e;var t=[],n=[],a={clients:{},labels:{}},l=$("#filter-label-ids").val();$.map(s,function(e){a.clients[""+e.client.id]=e.client.endpoint.replace(/^.*:\/\//,"").replace(/:.*$/,""),$.map(e.containers,function(e){e.labels&&$.map(e.labels,function(e,t){"all"!=l&&l.indexOf(t)==-1||(a.labels[t]||(a.labels[t]={}),a.labels[t][e]=!0)})})}),$.map(a.clients,function(e,n){t.push({key:n,value:e})}),$.map(a.labels,function(e,t){$.map(e,function(e,a){n.push({key:t,value:a})})}),t.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}),n.sort(function(e,t){return e.key<t.key?-1:e.key>t.key?1:e.value<t.value?-1:e.value>t.value?1:0}),i(t),o(n),r()}})});var f=React.createClass({displayName:"TableRow",propTypes:{content:React.PropTypes.object},statlog:function(){var e=$(ReactDOM.findDOMNode(this)),t=e.attr("data-container-id"),n="?client="+e.attr("data-client-id");app.func.link("/container/statlog/"+t+n)},render:function(){var e=this.props.content,t=e.id.substring(0,20);return React.createElement("tr",{"data-client-id":e.client,"data-container-id":t},React.createElement("td",{className:"data-name no-wrap"},e.time),React.createElement("td",{className:"data-name"},React.createElement("a",{onClick:this.statlog},e.id.substring(0,4))),React.createElement("td",{className:"data-name"},e.type),React.createElement("td",{className:"data-name data-force-break"},e.log.replace(/\[[0-9]+m/g,"")))}}),m=React.createClass({displayName:"Table",propTypes:{content:React.PropTypes.object},getInitialState:function(){return{data:[]}},load:function(e){var t={count:d};c.client!=-1&&(t.client=c.client),app.func.ajax({url:"/api/logs",data:t,success:function(t){return t.error?void e.setState({data:[]}):(p=t,void e.setState({data:e.filter()}))}})},filter:function(){var e=[],t={};return $.map(s,function(e){$.map(e.containers,function(e){if(0==c.label||c.label==-1&&!e.labels)t[e.id]=!0;else{if(!e.labels)return;var n=!1;$.map(e.labels,function(e,t){n|=c.label==app.func.hash(t+"->"+e)}),n&&(t[e.id]=!0)}})}),$.map(p,function(n){c.client!=-1&&n.client.id!=c.client||$.map(n.logs,function(a){t[a.id]&&($.map(a.stdout,function(t){e.push({client:n.client.id,id:a.id,type:"stdlog",key:t.substring(0,30),time:t.substring(5,19).replace("T"," "),log:t.substring(31)})}),$.map(a.stderr,function(t){e.push({client:n.client.id,id:a.id,type:"stderr",key:t.substring(0,30),time:t.substring(5,19).replace("T"," "),log:t.substring(31)})}))})}),e.sort(function(e,t){var n=new Date(e.key.substring(0,19)+"Z")-new Date(t.key.substring(0,19)+"Z");return 0!=n?n:parseInt(e.key.substring(20),10)-parseInt(t.key.substring(20),10)}),$(".logs").fadeIn(),e},componentDidMount:function(){this.load(this)},componentWillReceiveProps:function(e){return e.reload?void this.load(this):void this.setState({data:this.filter()})},render:function(){var e=[];return this.state.data.map(function(t){t.log&&e.push(React.createElement(f,{key:t.client+t.id+t.key,content:t}))}),React.createElement("table",{className:"table table-striped table-hover"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Time"),React.createElement("th",null,"ID"),React.createElement("th",null,"Type"),React.createElement("th",null,"Log"))),React.createElement("tbody",null,e))}});ReactDOM.render(React.createElement(m,{reload:!1}),document.getElementById("data"))},{}]},{},[1]);